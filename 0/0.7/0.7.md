## 0.7. Temas Individuales por Integrante (Informes)  
**Harold Muñante - Data Engineering: Proceso ETL desde un archivo Excel hacia SQL Server con Visual Studio**

---

### 1. Desarrollo Conceptual

El proceso **ETL (Extract, Transform, Load)** es un pilar fundamental en la ingeniería de datos, ya que permite extraer información desde diversas fuentes, transformarla conforme a reglas de negocio, y cargarla en un sistema de almacenamiento como **SQL Server**.

En este caso, se utiliza un archivo Excel como fuente de datos, aplicando transformaciones necesarias para asegurar la calidad e integridad, y finalmente se almacena en una base de datos relacional. Este proceso unifica datos heterogéneos y los prepara para su análisis o explotación en sistemas de inteligencia empresarial.

**Fases del ETL:**

- **Extract (Extracción):** Obtención de datos desde una fuente externa (Excel).
- **Transform (Transformación):** Limpieza, validación y adecuación de los datos según reglas de negocio.
- **Load (Carga):** Inserción estructurada en una base de datos SQL Server.

---

### 2. Consideraciones Técnicas

#### Herramientas Utilizadas

- **Visual Studio 2019**  
  Con la extensión *SQL Server Integration Services Projects (SSIS)*, permite crear, depurar y ejecutar flujos ETL de forma visual.

- **SQL Server Management Studio (SSMS) v18**  
  Herramienta de administración para SQL Server, utilizada para crear tablas, ejecutar consultas y verificar la carga de datos.

- **SQL Server Integration Services (SSIS)**  
  Plataforma ETL utilizada para orquestar el proceso completo desde la fuente Excel hasta el destino SQL Server.

- **Archivo Excel (.xlsx)**  
  Archivo `BBVA.xlsx` que contiene los datos originales a migrar.

- **.NET Framework / Lenguaje C# (opcional)**  
  Utilizable mediante el componente Script Task para tareas personalizadas dentro del flujo ETL.

---

### 3. Pasos Técnicos

#### Creación del Proyecto SSIS

1. Abrir Visual Studio 2019.
2. Instalar la extensión **SQL Server Integration Services Projects**.
3. Crear un nuevo proyecto del tipo **Integration Services Project**.

#### Configuración de la Fuente de Datos (Excel)

1. Arrastrar un **Data Flow Task** al panel de control.
2. Hacer doble clic para acceder al flujo de datos.
3. Insertar un componente **Excel Source**.
4. Configurar:
   - Ruta del archivo `BBVA.xlsx`.
   - Hoja específica (ej. `Hoja1$`).
   - Indicar si la primera fila contiene encabezados.

#### Transformación de Datos (opcional)

- **Derived Column:** Crear nuevas columnas derivadas.
- **Data Conversion:** Asegurar compatibilidad de tipos de datos.
- **Conditional Split:** Filtrar registros según condiciones.

#### Configuración del Destino (SQL Server)

1. Insertar componente **OLE DB Destination**.
2. Establecer conexión con la base de datos en SQL Server.
3. Crear manualmente la tabla `PLATAFORMA` (ver siguiente sección).
4. Mapear columnas del Excel con las de la tabla destino.

---

### 4. Demo: Proceso ETL de Excel a SQL Server con SSIS

#### Escenario de Integración

- **Fuente:** `BBVA.xlsx`
- **Destino:** Tabla `PLATAFORMA` en SQL Server
- **Transformación:** Conversión y validación de datos (si es necesario)

#### Script SQL para crear tabla de destino

```sql
CREATE TABLE [PLATAFORMA] (
    [DIVISION] nvarchar(255),
    [CodOficina] float,
    [Canal] nvarchar(255),
    [FECHA] float,
    [ESTADO] nvarchar(255),
    [TIPO_CLIENTE] nvarchar(255),
    [TIPO_DE_CLIENTE] nvarchar(255),
    [TIEMPO_ESPERA_SEGUNDOS] float,
    [NRO_TICKETS] float,
    [NRO_TICKETS_ON_TIME_VALIDOS] float,
    [NRO_TICKETS_VALIDOS] float,
    [NRO_TICKETS_NO_VALIDOS] float
);

Configuración del flujo en SSIS
Agregar Excel Source y vincular al archivo.

Insertar OLE DB Destination y configurar con SQL Server.

Mapear columnas de origen con la tabla PLATAFORMA.



5. Ejecución del Proceso
Ejecutar el paquete .dtsx desde Visual Studio (clic derecho > Execute Package).

Verificar que todos los pasos estén marcados con check verde.

Confirmar la carga en SSMS con la siguiente consulta:


SELECT TOP 10 * FROM PLATAFORMA;
Si los datos se visualizan correctamente, la ejecución fue exitosa.

6. Conclusión

El desarrollo del flujo ETL mediante SSIS representa una práctica clave en Data Engineering, facilitando la migración de datos desde archivos Excel hacia un sistema relacional como SQL Server. Esta automatización asegura la calidad, trazabilidad y disponibilidad de los datos, lo que habilita su uso posterior en análisis, dashboards o sistemas de toma de decisiones.

Además, el uso de herramientas como Visual Studio y SSMS permite una implementación robusta, escalable y mantenible en entornos empresariales modernos.

7. Referencias
Documentación Oficial de SSIS (Microsoft)

Documentación de SQL Server Management Studio (SSMS)

Repositorio GitHub - Azure Data Engineering

Tutorial en YouTube - Importar Excel en SSIS

Stack Overflow - Comunidad SSIS