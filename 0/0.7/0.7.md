
# Manuel Malpartida - Automatizaci√≥n de pruebas (Playwright)

# Playwright: Automatizaci√≥n de Pruebas de Interfaz de Usuario

## 1. Desarrollo Conceptual

Playwright es una herramienta de c√≥digo abierto para la automatizaci√≥n de pruebas de aplicaciones web. Desarrollada por Microsoft, permite interactuar con navegadores modernos como Chromium, Firefox y WebKit, ofreciendo soporte para m√∫ltiples lenguajes de programaci√≥n como JavaScript, Python, C#, y Java. Esta versatilidad lo convierte en una opci√≥n popular para la creaci√≥n de pruebas funcionales, de integraci√≥n y de extremo a extremo (E2E).

### Caracter√≠sticas Clave
- **Soporte Multinavegador:** Compatible con Chromium, Firefox y WebKit.
- **Automatizaci√≥n Completa:** Permite interactuar con elementos din√°micos como men√∫s, ventanas emergentes y di√°logos.
- **Capturas de Pantalla y Grabaci√≥n de Video:** √ötil para depuraci√≥n y documentaci√≥n de pruebas.
- **Ejecuta en Diferentes Entornos:** Incluye opciones para ejecutarse en local, contenedores o en la nube.

## 2. Consideraciones T√©cnicas

Antes de usar Playwright, es importante considerar los siguientes aspectos t√©cnicos:

### Requisitos del Sistema
- Node.js versi√≥n 14 o superior.
- Espacio en disco para los navegadores automatizados (~1 GB).
- Sistema operativo compatible: Windows, macOS, o Linux.

### Instalaci√≥n
Puedes instalar Playwright usando npm:

```bash
npm install playwright
```

### Configuraci√≥n Inicial
Para inicializar Playwright en tu proyecto:

```bash
npx playwright install
```
Esto descargar√° los navegadores necesarios.

### Organizaci√≥n de Pruebas
Es recomendable mantener las pruebas organizadas en carpetas separadas, siguiendo convenciones como:
- `/tests`: Directorio de pruebas.
- `/helpers`: Utilidades o funciones compartidas.
- `/config`: Configuraci√≥n personalizada.

## 3. Demo: Primeros Pasos con Playwright

A continuaci√≥n, se muestra un ejemplo b√°sico de c√≥mo usar Playwright para realizar una prueba de inicio de sesi√≥n en un sitio web ficticio.

### Escenario de Prueba

#### Prueba Sencilla: Validar el t√≠tulo de la p√°gina principal

```javascript
const { chromium } = require('playwright');

(async () => {
    const browser = await chromium.launch();
    const page = await browser.newPage();

    await page.goto('https://www.bing.com');
    const title = await page.title();

    if (title.includes('Bing')) {
        console.log('El t√≠tulo de la p√°gina contiene la palabra "Bing". Prueba exitosa.');
    } else {
        console.log('El t√≠tulo de la p√°gina no contiene la palabra "Bing". Prueba fallida.');
    }

    await browser.close();
})();
```

#### Prueba Mediana: B√∫squeda en Bing

```javascript
const { chromium } = require('playwright');

(async () => {
    const browser = await chromium.launch();
    const page = await browser.newPage();

    await page.goto('https://www.bing.com');

    await page.fill('input[name="q"]', 'Playwright testing');
    await page.press('input[name="q"]', 'Enter');

    // Esperar a que aparezca al menos un resultado
    await page.waitForSelector('#b_results > li.b_algo', { timeout: 10000 });

    // Obtener los resultados de Bing
    const results = await page.$$eval('#b_results > li.b_algo', nodes => nodes.map(n => n.textContent.trim()));
    console.log(`Resultados encontrados: ${results.length}`);
    results.forEach((r, i) => console.log(`Resultado ${i + 1}: ${r.substring(0, 100)}...`));

    await browser.close();
})();

```

#### Prueba Avanzada: Validar flujo de compra en un sitio de demostraci√≥n

```javascript
const { chromium } = require('playwright');

(async () => {
    const browser = await chromium.launch({ headless: false });
    const page = await browser.newPage();

    await page.goto('https://magento2demo.firebearstudio.com/');
    console.log('P√°gina principal cargada');

    // Buscar un producto
    await page.fill('input#search', 'bag');
    await page.press('input#search', 'Enter');
    console.log('B√∫squeda realizada');

    // Esperar a que aparezcan los resultados
    await page.waitForSelector('.product-item-info', { timeout: 15000 });
    console.log('Resultados visibles');

    // Hacer clic en el primer producto
    await page.click('.product-item-info a.product-item-link');
    console.log('Primer producto seleccionado');

    // Esperar a que el bot√≥n de agregar al carrito est√© disponible
    await page.waitForSelector('button#product-addtocart-button', { timeout: 15000 });
    await page.click('button#product-addtocart-button');
    console.log('Producto agregado al carrito');

    // Esperar el mensaje de √©xito
    await page.waitForSelector('.message-success', { timeout: 15000 });
    console.log('Flujo de compra validado exitosamente.');

    await browser.close();
})();
```

### Ejecuci√≥n de la Prueba
Guarda el c√≥digo de la prueba en un archivo, por ejemplo, `test.js`, y ejec√∫talo con:

```bash
node test.js
```

### Resultado Esperado
- **Prueba Sencilla:** Se verifica que el titulo de la p√°gina sea "Bing".
- **Prueba Mediana:** Se muestran resultados de b√∫squeda en Bing.
- **Prueba Avanzada:** Se confirma el flujo de compra en un sitio de demostraci√≥n.

## 4. Conclusi√≥n

Playwright es una herramienta poderosa y flexible para la automatizaci√≥n de pruebas. Su capacidad para trabajar con m√∫ltiples navegadores y su enfoque en pruebas confiables lo hacen ideal para proyectos de desarrollo modernos. La simplicidad en su configuraci√≥n inicial y la riqueza de sus funcionalidades permiten a los equipos de desarrollo asegurar la calidad del software de manera eficiente.

## 5. Referencias

- [Documentaci√≥n Oficial de Playwright](https://playwright.dev/)
- [Repositorio en GitHub](https://github.com/microsoft/playwright)
- [Tutoriales y Ejemplos en Playwright.dev](https://playwright.dev/docs/intro)
## 0.7. Temas Individuales por Integrante (Informes)  


**Harold Mu√±ante - Data Engineering: Proceso ETL desde un archivo Excel hacia SQL Server con Visual Studio**

---

### 1. Desarrollo Conceptual

El proceso **ETL (Extract, Transform, Load)** es un pilar fundamental en la ingenier√≠a de datos, ya que permite extraer informaci√≥n desde diversas fuentes, transformarla conforme a reglas de negocio, y cargarla en un sistema de almacenamiento como **SQL Server**.

En este caso, se utiliza un archivo Excel como fuente de datos, aplicando transformaciones necesarias para asegurar la calidad e integridad, y finalmente se almacena en una base de datos relacional. Este proceso unifica datos heterog√©neos y los prepara para su an√°lisis o explotaci√≥n en sistemas de inteligencia empresarial.

**Fases del ETL:**

- **Extract (Extracci√≥n):** Obtenci√≥n de datos desde una fuente externa (Excel).
- **Transform (Transformaci√≥n):** Limpieza, validaci√≥n y adecuaci√≥n de los datos seg√∫n reglas de negocio.
- **Load (Carga):** Inserci√≥n estructurada en una base de datos SQL Server.

---

### 2. Consideraciones T√©cnicas

#### Herramientas Utilizadas

- **Visual Studio 2019**  
  Con la extensi√≥n *SQL Server Integration Services Projects (SSIS)*, permite crear, depurar y ejecutar flujos ETL de forma visual.

- **SQL Server Management Studio (SSMS) v18**  
  Herramienta de administraci√≥n para SQL Server, utilizada para crear tablas, ejecutar consultas y verificar la carga de datos.

- **SQL Server Integration Services (SSIS)**  
  Plataforma ETL utilizada para orquestar el proceso completo desde la fuente Excel hasta el destino SQL Server.

- **Archivo Excel (.xlsx)**  
  Archivo `BBVA.xlsx` que contiene los datos originales a migrar.

- **.NET Framework / Lenguaje C# (opcional)**  
  Utilizable mediante el componente Script Task para tareas personalizadas dentro del flujo ETL.

---

### 3. Pasos T√©cnicos

#### Creaci√≥n del Proyecto SSIS

1. Abrir Visual Studio 2019.
2. Instalar la extensi√≥n **SQL Server Integration Services Projects**.
3. Crear un nuevo proyecto del tipo **Integration Services Project**.

#### Configuraci√≥n de la Fuente de Datos (Excel)

1. Arrastrar un **Data Flow Task** al panel de control.
2. Hacer doble clic para acceder al flujo de datos.
3. Insertar un componente **Excel Source**.
4. Configurar:
   - Ruta del archivo `BBVA.xlsx`.
   - Hoja espec√≠fica (ej. `Hoja1$`).
   - Indicar si la primera fila contiene encabezados.

#### Transformaci√≥n de Datos (opcional)

- **Derived Column:** Crear nuevas columnas derivadas.
- **Data Conversion:** Asegurar compatibilidad de tipos de datos.
- **Conditional Split:** Filtrar registros seg√∫n condiciones.

#### Configuraci√≥n del Destino (SQL Server)

1. Insertar componente **OLE DB Destination**.
2. Establecer conexi√≥n con la base de datos en SQL Server.
3. Crear manualmente la tabla `PLATAFORMA` (ver siguiente secci√≥n).
4. Mapear columnas del Excel con las de la tabla destino.

---

### 4. Demo: Proceso ETL de Excel a SQL Server con SSIS

#### Escenario de Integraci√≥n

- **Fuente:** `BBVA.xlsx`
- **Destino:** Tabla `PLATAFORMA` en SQL Server
- **Transformaci√≥n:** Conversi√≥n y validaci√≥n de datos (si es necesario)

#### Script SQL para crear tabla de destino

```sql
CREATE TABLE [PLATAFORMA] (
    [DIVISION] nvarchar(255),
    [CodOficina] float,
    [Canal] nvarchar(255),
    [FECHA] float,
    [ESTADO] nvarchar(255),
    [TIPO_CLIENTE] nvarchar(255),
    [TIPO_DE_CLIENTE] nvarchar(255),
    [TIEMPO_ESPERA_SEGUNDOS] float,
    [NRO_TICKETS] float,
    [NRO_TICKETS_ON_TIME_VALIDOS] float,
    [NRO_TICKETS_VALIDOS] float,
    [NRO_TICKETS_NO_VALIDOS] float
);
```

#### Configuraci√≥n del flujo en SSIS

1. Agregar **Excel Source** y vincular al archivo.
2. Insertar **OLE DB Destination** y configurar con SQL Server.
3. Mapear columnas de origen con la tabla `PLATAFORMA`.

---

### 5. Ejecuci√≥n del Proceso

1. Ejecutar el paquete `.dtsx` desde Visual Studio (clic derecho > *Execute Package*).
2. Verificar que todos los pasos est√©n marcados con **check verde**.
3. Confirmar la carga en SSMS con la siguiente consulta:

```sql
USE CC_FUENTES_SH;
SELECT * FROM  PLATAFORMA; 
SELECT TOP 10 * FROM PLATAFORMA;
SELECT * FROM  VENTANILLA; 
SELECT TOP 10 * FROM VENTANILLA;
```

Si los datos se visualizan correctamente, la ejecuci√≥n fue exitosa.

---

### 6. Conclusi√≥n

El desarrollo del flujo ETL mediante **SSIS** representa una pr√°ctica clave en **Data Engineering**, facilitando la migraci√≥n de datos desde archivos Excel hacia un sistema relacional como SQL Server. Esta automatizaci√≥n asegura la calidad, trazabilidad y disponibilidad de los datos, lo que habilita su uso posterior en an√°lisis, dashboards o sistemas de toma de decisiones.

Adem√°s, el uso de herramientas como Visual Studio y SSMS permite una implementaci√≥n robusta, escalable y mantenible en entornos empresariales modernos.

---

### 7. Referencias

## 5. Referencias

- [Documentaci√≥n Oficial de SSIS (Microsoft)](https://docs.microsoft.com/sql/integration-services/)
- [Documentaci√≥n de SQL Server Management Studio (SSMS)](https://docs.microsoft.com/sql/ssms/sql-server-management-studio-ssms)
- [Repositorio GitHub - Azure Data Engineering](https://github.com/DataCounsel/Azure-Data-Engineering)
- [Tutorial en YouTube - Importar Excel en SSIS](https://www.youtube.com/watch?v=sbeuralzJ70)
- [Stack Overflow - Comunidad SSIS](https://stackoverflow.com/questions/tagged/ssis)
- [üõ†Ô∏è Descargar Visual Studio Tools for Applications 2019](https://www.microsoft.com/es-co/download/details.aspx?id=58317)
