0.7. Temas Individuales por Integrante (Informes)
Harold Muñante  - Data Engineering
Proceso ETl desde un archivo Excel hacia SQL Server con Visual studio
1. Desarrollo Conceptual
El proceso ETL (Extract, Transform, Load) es un componente esencial en la arquitectura de software orientada a datos. Consiste en extraer datos desde una fuente (en este caso, un archivo Excel), transformarlos según las reglas de negocio necesarias, y cargarlos en un sistema de almacenamiento, como una base de datos relacional (SQL Server).

El objetivo del proceso ETL es facilitar la integración y migración de datos desde distintas fuentes hacia un sistema unificado, promoviendo la calidad, consistencia y disponibilidad de los datos para su análisis o procesamiento posterior.

Este enfoque es independiente de tecnologías específicas. En esencia:

Extract (Extracción): Accede a los datos desde su fuente de origen.

Transform (Transformación): Realiza validaciones, conversiones de tipo, limpieza y reglas de negocio.

Load (Carga): Inserta los datos en el destino de almacenamiento.


2. Consideraciones Técnicas
Herramientas Utilizadas
Visual Studio 2019 con SQL Server Data Tools (SSDT)
Visual Studio 2019, junto con la extensión SQL Server Integration Services Projects, permite desarrollar, depurar y ejecutar paquetes ETL. Esta versión es estable y ampliamente usada en entornos empresariales.

SQL Server Management Studio (SSMS) versión 18
SSMS es la herramienta de administración para SQL Server. La versión 18 ofrece soporte completo para versiones modernas de SQL Server, incluyendo capacidades como:

Ejecución y depuración de scripts SQL.

Visualización y edición de estructuras de tablas.

Seguimiento de actividad y rendimiento del servidor.

Conexión con instancias locales o en la nube (Azure SQL, etc.).

SQL Server Integration Services (SSIS)
Plataforma de ETL usada para extraer datos de distintas fuentes, transformarlos y cargarlos en un destino. Proporciona componentes visuales para flujos de trabajo de datos.

Archivo Excel (.xlsx)
El archivo de origen BBVA.xlsx contiene la información a migrar, y actúa como fuente de datos para la operación ETL.

.NET Framework / Lenguaje C# (opcional)
Se puede usar para integrar scripts personalizados dentro del flujo SSIS mediante el componente Script Task, útil para validaciones complejas o automatización adicional.

Pasos Técnicos
Creación del Proyecto SSIS en Visual Studio 2019

Abrir Visual Studio 2019.

Instalar la extensión “SQL Server Integration Services Projects” desde el instalador de Visual Studio.

Crear un nuevo proyecto del tipo Integration Services Project.

Configuración de la Fuente de Datos (Excel)

Arrastrar un componente Data Flow Task desde la caja de herramientas al panel de control.

Hacer doble clic para entrar al flujo de datos.

Agregar un componente Excel Source.

Configurar la conexión al archivo BBVA.xlsx, especificando:

Ruta del archivo.

Hoja a utilizar (ejemplo: Hoja1$).

Si la primera fila contiene nombres de columna.

Transformación de Datos (opcional)

Insertar transformaciones como:

Derived Column: para crear nuevas columnas a partir de las existentes.

Data Conversion: para asegurar compatibilidad de tipos de datos.

Conditional Split: para filtrar o enrutar registros según reglas.

Configuración del Destino (SQL Server)

Insertar un componente OLE DB Destination.

Configurar la conexión a la instancia de SQL Server a través de SSMS (versión 18).

Crear manualmente la tabla de destino (ver sección Demo).

Mapear columnas de origen con columnas de destino.

Ejecución y Verificación

Ejecutar el paquete directamente desde Visual Studio.

Verificar los resultados en SQL Server mediante SSMS:

Consultar la tabla destino para confirmar los registros.

Validar tipos de datos y estructura.


3. Demo: Proceso ETL desde Excel hacia SQL Server usando SSIS
A continuación, se muestra un ejemplo básico de cómo utilizar SQL Server Integration Services (SSIS) para extraer datos desde un archivo Excel (BBVA.xlsx) y cargarlos en una tabla SQL Server llamada PLATAFORMA.

Escenario de Integración
Cargar el archivo Excel con información de atención de clientes.

Transformar los datos si es necesario (e.g. convertir tipos).

Cargar los datos en la tabla PLATAFORMA de SQL Server.

Script de Creación de Tabla en SQL Server
sql
Copiar
Editar
CREATE TABLE [PLATAFORMA] (
    [DIVISION] nvarchar(255),
    [CodOficina] float,
    [Canal] nvarchar(255),
    [FECHA] float,
    [ESTADO] nvarchar(255),
    [TIPO_CLIENTE] nvarchar(255),
    [TIPO_DE_CLIENTE] nvarchar(255),
    [TIEMPO_ESPERA_SEGUNDOS] float,
    [NRO_TICKETS] float,
    [NRO_TICKETS_ON_TIME_VALIDOS] float,
    [NRO_TICKETS_VALIDOS] float,
    [NRO_TICKETS_NO_VALIDOS] float
);
Configuración del Proyecto SSIS
Crear un nuevo Integration Services Project en Visual Studio 2019.

Agregar un Data Flow Task.

Dentro del flujo:

Agregar un Excel Source, y vincularlo al archivo BBVA.xlsx.

Agregar un OLE DB Destination.

Configurar la conexión a tu instancia de SQL Server (local o remota).

Mapear cada columna del Excel con las columnas correspondientes en la tabla PLATAFORMA.

Ejecución del Proceso
Una vez completada la configuración:

Haz clic derecho sobre el paquete .dtsx y selecciona "Execute Package".

Visual Studio ejecutará el flujo ETL.

Si la ejecución fue exitosa, verás todos los pasos marcados con check verde.

Resultado Esperado
Al finalizar, puedes verificar la carga ejecutando la siguiente consulta en SQL Server Management Studio 18:

sql
Copiar
Editar
SELECT TOP 10 * FROM PLATAFORMA;
Si los datos se ven correctamente, el proceso fue exitoso. Puedes esperar ver los registros provenientes del archivo BBVA.xlsx cargados en la tabla.


4. Conclusión

Este proyecto forma parte de las tareas fundamentales de la Ingeniería de Datos (Data Engineering), ya que aborda el diseño y construcción de un proceso ETL —Extract, Transform, Load— utilizando herramientas como SQL Server Integration Services (SSIS). A través de este flujo, se facilita la migración y estructuración de datos provenientes de un archivo Excel hacia una base de datos relacional, asegurando consistencia, trazabilidad y preparación de los datos para su análisis. Esto permite sentar las bases de una arquitectura de datos sólida, escalable y mantenible, alineada con los principios del desarrollo moderno de software y análisis empresarial.

5. Referencias
Documentación Oficial de SQL Server Integration Services (SSIS)
https://docs.microsoft.com/sql/integration-services/
Guía oficial de Microsoft sobre el uso de SSIS para crear flujos ETL, componentes disponibles, y prácticas recomendadas.

Documentación de SQL Server Management Studio (SSMS)
https://docs.microsoft.com/sql/ssms/sql-server-management-studio-ssms
Documentación sobre el entorno SSMS, cómo administrar bases de datos, ejecutar consultas y verificar datos.


Repositorio de Ejemplo en GitHub: Proyecto de Data Engineering
https://github.com/DataCounsel/Azure-Data-Engineering


Tutorial:Importar un excel de sql server hacia visual studio tools 2019
https://www.youtube.com/watch?v=sbeuralzJ70
Tutorial paso a paso que muestra cómo configurar un flujo SSIS para importar archivos Excel a SQL Server.

Foros y comunidad de Stack Overflow
https://stackoverflow.com/questions/tagged/ssis
Comunidad activa para resolver errores, obtener recomendaciones de diseño y resolver dudas específicas sobre paquetes SSIS.

